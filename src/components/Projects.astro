---
import { getCollection } from "astro:content";
import DemoButton from "./DemoButton.astro";
import CodeButton from "./CodeButton.astro";

const projects = await getCollection("projects");

// Debug: ver los datos de cada proyecto
// projects.forEach(project => {
// 	console.log(`Proyecto: ${project.data.title}`)
// 	console.log('Demo:', project.data.demo)
// 	console.log('Code:', project.data.code)
// 	console.log('---')
// })

// Renderizar el contenido de cada proyecto
const renderedProjects = await Promise.all(
  projects.map(async (project) => {
    const { Content } = await project.render();
    return { ...project, Content };
  })
);
---

<div class="mt-20">
  <section class="container">
    <h2
      class="text-xl md:text-2xl font-bold mb-5 fade-in-up"
    >
      Proyectos
    </h2>

    <div class="grid md:grid-cols-2 gap-5">
      {
        renderedProjects.map((project, index) => {
          const { data } = project;
          const { title, tech, img, demo, code } = data;

          return (
            <div
              class="flex flex-col justify-between space-y-2 p-3 bg-card rounded-xl fade-in-up"
              style={`transition-delay: ${index * 0.1}s`}
            >
              <div class="flex flex-col gap-5 text-zinc-600 leading-relaxed dark:text-zinc-300">
                <h3 class="text-gray-200 text-lg md:text-xl font-bold">{title}</h3>

                <project.Content />

                <p>{tech}</p>
              </div>

              <div class="flex gap-3 mt-5">
                {demo && <DemoButton demo={demo} />}
                {code && <CodeButton code={code} />}
              </div>
            </div>
          );
        })
      }
    </div>
  </section>
</div>
